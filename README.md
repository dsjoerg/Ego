super ugly work in progress.  code stolen from https://github.com/voyage11/Location and many stacko'erflows